# Face Recognition Attendance System

A web-based facial recognition system for tracking attendance. Built with React and PHP, it uses face-api.js for face detection and matching, with encrypted storage of biometric data.

## Features

- Real-time face detection and recognition
- User registration with face enrollment
- Automated check-in system
- Daily attendance reports
- Encrypted face data storage (AES-256)
- Blockchain-inspired hash chaining for log integrity

## Tech Stack

**Frontend**
- React with Vite
- face-api.js for facial recognition
- TensorFlow.js models

**Backend**
- PHP 7.4+
- MySQL database
- OpenSSL for encryption

## Installation

### Prerequisites

- XAMPP (or similar PHP/MySQL environment)
- Node.js and npm
- Modern web browser with webcam access

### Database Setup

1. Create the database:
```sql
CREATE DATABASE face_recognition;
```

2. Import the schema:
```bash
mysql -u root face_recognition < backend/schema.sql
```

3. Update descriptor column for encryption:
```sql
ALTER TABLE users MODIFY COLUMN descriptor TEXT;
```

### Encryption Setup

**This step is required** - face descriptors are encrypted before storage.

1. Generate an encryption key:
```bash
php backend/scripts/generate_key.php
```

2. Set the key as an environment variable:

**Windows:**
```powershell
$env:FACE_ENCRYPTION_KEY = "your-generated-key"
```

**Linux/Mac:**
```bash
export FACE_ENCRYPTION_KEY="your-generated-key"
```

For detailed encryption setup, see [ENCRYPTION_SETUP.md](ENCRYPTION_SETUP.md)

### Frontend Setup

```bash
cd face-id
npm install
npm run dev
```

### Backend Configuration

Edit `backend/config/Database.php` if needed:
```php
private $host = 'localhost';
private $db_name = 'face_recognition';
private $user = 'root';
private $password = '';
```

## Project Structure

```
backend/
├── config/          Database connection
├── controllers/     API endpoints
├── models/          Data models
├── utils/           Encryption utilities
└── scripts/         Setup and migration tools

face-id/
├── src/
│   └── pages/       Registration, Recognition, Reports
└── public/
    └── models/      face-api.js TensorFlow models
```

## API Endpoints

**Register User**
```
POST /backend/api/users/register
{
  "name": "John Doe",
  "phone": "1234567890",
  "descriptor": [128 float values]
}
```

**Recognize Face**
```
POST /backend/api/recognition/recognize
{
  "descriptor": [128 float values]
}
```

**Check In**
```
POST /backend/api/recognition/checkin
{
  "user_id": 1,
  "confidence": 0.95
}
```

**Get Reports**
```
GET /backend/api/reports/today
GET /backend/api/reports/range?start=2024-01-01&end=2024-01-31
```

## Usage

1. **Registration**: Navigate to the registration page, enter name and phone number, and capture your face
2. **Recognition**: Use the recognition page to identify registered users
3. **Check-in**: After recognition, confirm check-in
4. **Reports**: View attendance records and statistics

## Security

Face descriptors are encrypted using AES-256-CBC before database storage. Each encryption uses a unique initialization vector (IV). The encryption key must be set via environment variable and should never be committed to version control.

See [ENCRYPTION_SETUP.md](ENCRYPTION_SETUP.md) for complete security documentation.

## Development

The system uses a confidence threshold of 0.35 for face matching. Lower values = stricter matching. Adjust in `RecognitionController.php` if needed.

Face descriptors are 128-dimensional arrays generated by face-api.js using the FaceNet model.

## Notes

- Requires good lighting for reliable face detection
- Users must face the camera directly during registration
- Each user can only check in once per day
- Encryption key loss means permanent data loss - back it up securely
